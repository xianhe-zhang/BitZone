{"ast":null,"code":"import _regeneratorRuntime from\"/Users/marioxzhang/Desktop/bitzone-finished/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/marioxzhang/Desktop/bitzone-finished/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/marioxzhang/Desktop/bitzone-finished/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback,useRef,useEffect}from'react';export var useHttpClient=function useHttpClient(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var activeHttpRequests=useRef([]);var sendRequest=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var method,body,headers,httpAbortCtrl,response,responseData,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:method=_args.length>1&&_args[1]!==undefined?_args[1]:'GET';body=_args.length>2&&_args[2]!==undefined?_args[2]:null;headers=_args.length>3&&_args[3]!==undefined?_args[3]:{};setIsLoading(true);httpAbortCtrl=new AbortController();activeHttpRequests.current.push(httpAbortCtrl);_context.prev=6;_context.next=9;return fetch(url,{method:method,body:body,headers:headers,signal:httpAbortCtrl.signal});case 9:response=_context.sent;_context.next=12;return response.json();case 12:responseData=_context.sent;activeHttpRequests.current=activeHttpRequests.current.filter(function(reqCtrl){return reqCtrl!==httpAbortCtrl;});if(response.ok){_context.next=16;break;}throw new Error(responseData.message);case 16:setIsLoading(false);return _context.abrupt(\"return\",responseData);case 20:_context.prev=20;_context.t0=_context[\"catch\"](6);setError(_context.t0.message);setIsLoading(false);throw _context.t0;case 25:case\"end\":return _context.stop();}}},_callee,null,[[6,20]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);var clearError=function clearError(){setError(null);};useEffect(function(){return function(){// eslint-disable-next-line react-hooks/exhaustive-deps\nactiveHttpRequests.current.forEach(function(abortCtrl){return abortCtrl.abort();});};},[]);return{isLoading:isLoading,error:error,sendRequest:sendRequest,clearError:clearError};};","map":{"version":3,"sources":["/Users/marioxzhang/Desktop/bitzone-finished/frontend/src/shared/hooks/http-hook.js"],"names":["useState","useCallback","useRef","useEffect","useHttpClient","isLoading","setIsLoading","error","setError","activeHttpRequests","sendRequest","url","method","body","headers","httpAbortCtrl","AbortController","current","push","fetch","signal","response","json","responseData","filter","reqCtrl","ok","Error","message","clearError","forEach","abortCtrl","abort"],"mappings":"8fAAA,OAASA,QAAT,CAAmBC,WAAnB,CAAgCC,MAAhC,CAAwCC,SAAxC,KAAyD,OAAzD,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACjC,cAAkCJ,QAAQ,CAAC,KAAD,CAA1C,wCAAOK,SAAP,eAAkBC,YAAlB,eACA,eAA0BN,QAAQ,EAAlC,yCAAOO,KAAP,eAAcC,QAAd,eAEA,GAAMC,CAAAA,kBAAkB,CAAGP,MAAM,CAAC,EAAD,CAAjC,CAEA,GAAMQ,CAAAA,WAAW,CAAGT,WAAW,0FAC7B,iBAAOU,GAAP,8LAAYC,MAAZ,+CAAqB,KAArB,CAA4BC,IAA5B,+CAAmC,IAAnC,CAAyCC,OAAzC,+CAAmD,EAAnD,CACER,YAAY,CAAC,IAAD,CAAZ,CACMS,aAFR,CAEwB,GAAIC,CAAAA,eAAJ,EAFxB,CAGEP,kBAAkB,CAACQ,OAAnB,CAA2BC,IAA3B,CAAgCH,aAAhC,EAHF,sCAM2BI,CAAAA,KAAK,CAACR,GAAD,CAAM,CAChCC,MAAM,CAANA,MADgC,CAEhCC,IAAI,CAAJA,IAFgC,CAGhCC,OAAO,CAAPA,OAHgC,CAIhCM,MAAM,CAAEL,aAAa,CAACK,MAJU,CAAN,CANhC,QAMUC,QANV,sCAa+BA,CAAAA,QAAQ,CAACC,IAAT,EAb/B,SAaUC,YAbV,eAeId,kBAAkB,CAACQ,OAAnB,CAA6BR,kBAAkB,CAACQ,OAAnB,CAA2BO,MAA3B,CAC3B,SAAAC,OAAO,QAAIA,CAAAA,OAAO,GAAKV,aAAhB,EADoB,CAA7B,CAfJ,GAmBSM,QAAQ,CAACK,EAnBlB,+BAoBY,IAAIC,CAAAA,KAAJ,CAAUJ,YAAY,CAACK,OAAvB,CApBZ,SAuBItB,YAAY,CAAC,KAAD,CAAZ,CAvBJ,gCAwBWiB,YAxBX,4DA0BIf,QAAQ,CAAC,YAAIoB,OAAL,CAAR,CACAtB,YAAY,CAAC,KAAD,CAAZ,CA3BJ,uFAD6B,+DAgC7B,EAhC6B,CAA/B,CAmCA,GAAMuB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBrB,QAAQ,CAAC,IAAD,CAAR,CACD,CAFD,CAIAL,SAAS,CAAC,UAAM,CACd,MAAO,WAAM,CACX;AACAM,kBAAkB,CAACQ,OAAnB,CAA2Ba,OAA3B,CAAmC,SAAAC,SAAS,QAAIA,CAAAA,SAAS,CAACC,KAAV,EAAJ,EAA5C,EACD,CAHD,CAID,CALQ,CAKN,EALM,CAAT,CAOA,MAAO,CAAE3B,SAAS,CAATA,SAAF,CAAaE,KAAK,CAALA,KAAb,CAAoBG,WAAW,CAAXA,WAApB,CAAiCmB,UAAU,CAAVA,UAAjC,CAAP,CACD,CArDM","sourcesContent":["import { useState, useCallback, useRef, useEffect } from 'react';\n\nexport const useHttpClient = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState();\n\n  const activeHttpRequests = useRef([]);\n\n  const sendRequest = useCallback(\n    async (url, method = 'GET', body = null, headers = {}) => {\n      setIsLoading(true);\n      const httpAbortCtrl = new AbortController();\n      activeHttpRequests.current.push(httpAbortCtrl);\n\n      try {\n        const response = await fetch(url, {\n          method,\n          body,\n          headers,\n          signal: httpAbortCtrl.signal\n        });\n\n        const responseData = await response.json();\n\n        activeHttpRequests.current = activeHttpRequests.current.filter(\n          reqCtrl => reqCtrl !== httpAbortCtrl\n        );\n\n        if (!response.ok) {\n          throw new Error(responseData.message);\n        }\n\n        setIsLoading(false);\n        return responseData;\n      } catch (err) {\n        setError(err.message);\n        setIsLoading(false);\n        throw err;\n      }\n    },\n    []\n  );\n\n  const clearError = () => {\n    setError(null);\n  };\n\n  useEffect(() => {\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      activeHttpRequests.current.forEach(abortCtrl => abortCtrl.abort());\n    };\n  }, []);\n\n  return { isLoading, error, sendRequest, clearError };\n};\n"]},"metadata":{},"sourceType":"module"}